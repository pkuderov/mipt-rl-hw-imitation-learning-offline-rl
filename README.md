# Домашнее задание №2. Имитационное обучение и оффлайн обучение с подкреплением

## Теоретическое задание

Теоретическое задание посвящено понятиям среднее вознаграждение и дифференциал полезности.

**Задание 1. Упражнение 10.6 книги Саттона и Барто.** Расмотрим марковский процесс (примечание: просто процесс, не МППР!), состоящий из трех состояний A, B, C; переход производятся детерминированно по циклу. Вознаграждение $+1$ начисляется по прибытии в состояние A, в остальных случаях оно равно 0. Каковы дифференциалы для полезностей во всех трех состояний?

**Задание 2. Упражнение 10.8 из книги Саттона и Барто.** Псевдокод на стр.296-297 над упражнением "10.6 - Дифференциальный полуградиентный Sarsa для оценивания $\hat{q} = q_*$" обновляет $\hat{R}_{t+1}$, используя в качестве ошибки $\delta_t$ (см. формулу 10.10), а не просто $R_{t+1} - \hat{R}_{t+1}$. Годятся оба определения ошибки, но $\delta_t$ дает лучшие результаты.

Чтобы понять почему, рассмотрим циклический МППР с тремя состояниями из задания 1. Оценка среднего вознаграждения должна стремиться к своему истинному значению $\frac{1}{3}$. Предположим, что она уже принимала это значение и там и осталась. Какой тогда была бы последовательность $R_t - \hat{R}_t$? А какой была бы последовательность $\delta_t$? Какая последовательность давала бы более устойчивую оценку среднего вознаграждения, если бы оценке было разрешено изменяться в ответ на ошибки?

## Практическое задание

Практическое задание посвящено темам imitation learning и offline RL. Тетрадка с заданием представлена [в репозитории](imitation_learning_offline_rl.ipynb) и в [Google Colab](https://colab.research.google.com/drive/1V53JfJ0xzlaHG4LX_y5T3vhgL4sW0ffd).

## Формат сдачи

Сдача осуществляется путем создания Pull Request'а. *В GitHub Classroom PR будет создан автоматически, когда вы запушите первый коммит*.

Убедитесь, что:

- в PR есть и лежит на видном месте финальная версия вашего кода: ссылкой на колаб и/или коммитом тетради.
- в коммитах нет лишнего мусора, output в ячейках ноутбука не требует бесконечно их скроллить.
- на видном месте и в удобной для просмотра форме сам отчет (pdf, markdown, отчет в wandb и тп)
- на видном месте ссылка на логи запусков в wandb.
- текст читаемый, если теоретическое задание сдается письменно от руки (т.е. сканы/фото, объединенные в pdf)
